{
	# Optional: receive expiry/alerts on failures
	email mortremofficial@gmail.com
	# For testing only, you could toggle staging CA:
	# acme_ca https://acme-staging-v02.api.letsencrypt.org/directory
}

# Redirect HTTP -> HTTPS
http://{$DOMAIN} {
	redir https://{$DOMAIN}{uri} permanent
}

# Primary site (automatic certificates)
{$DOMAIN} {
	root * /srv
	encode zstd gzip

	# SPA: serve index.html for unknown routes
	route {
		try_files {path} /index.html
		file_server
	}

	# cache static files aggressively
	header /assets/* Cache-Control "public, max-age=2592000, immutable"

	# (Optional) security headers
	header {
		Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
		X-Content-Type-Options "nosniff"
		Referrer-Policy "no-referrer-when-downgrade"
	}
}
